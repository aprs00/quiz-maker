import{j as e,F as j,G as Q,r as u,l as A,k as x}from"./index-4e0b3dbf.js";import{S as o}from"./Skeleton-c88f9f7d.js";import{D as w,u as z,T as g,M as v}from"./use-form-241aae4b.js";import{g as E,e as C,h as U,i as B,j as P}from"./styles-b1301c43.js";const M=()=>e.jsxs(j,{gap:"lg",direction:"column",children:[e.jsx(o,{height:40,width:320,radius:"sm"}),e.jsx(o,{height:400,radius:"sm"}),e.jsx(w,{}),e.jsx(o,{height:40,width:260,radius:"sm"}),e.jsx(o,{height:40,radius:"sm"}),e.jsx(o,{height:40,radius:"sm"}),e.jsx(w,{}),e.jsxs(Q,{position:"right",children:[e.jsx(o,{height:40,width:100,radius:"sm"}),e.jsx(o,{height:40,width:100,radius:"sm"})]})]}),H=()=>{const[l,b]=u.useState(),{goBack:N,id:q}=E(),{classes:f}=C(),{data:i,isLoading:F}=U(Number(q)),{data:d}=B(),{mutate:S,isLoading:y}=P(Number(q)||0),r=z({initialValues:{name:"",questions:[]},validate:s=>{const t={};return s.name||(t.name="Name is required"),s.questions||(t.questions="Questions are required"),t}}),n=z({initialValues:{answer:"",question:"",id:null,newQuestion:!0},validate:s=>{const t={};return s.question||(t.question="Question is required"),s.answer||(t.answer="Answer is required"),t}});console.log(n);const k=u.useMemo(()=>[...(d??[]).map(s=>({label:s.question,value:s.id.toString()})),...(l??[]).map(s=>({label:s.question,value:s.id!==null?s.id.toString():""}))],[d,l]),I=u.useCallback(s=>{const{question:t,answer:h}=s,c=crypto.getRandomValues(new Uint32Array(1))[0],m={question:t,answer:h,id:c,newQuestion:!0};b(p=>[...p||[],m]),n.reset(),r.setFieldValue("questions",[...r.values.questions||[],c.toString()])},[b,n]),L=u.useCallback(s=>{var m;const t=[...d??[],...l??[]],h=(m=s.questions)==null?void 0:m.map(p=>{const a=t==null?void 0:t.find(V=>V.id===Number(p));if(a)return"newQuestion"in a&&(a!=null&&a.newQuestion)?{question:a.question,answer:a.answer}:a}),c={name:s.name,questions:h};S(c)},[S,d,l,k]);return u.useEffect(()=>{r.setValues({name:i==null?void 0:i.name,questions:i==null?void 0:i.questions.map(s=>s.id.toString())})},[i]),F?e.jsx(M,{}):e.jsxs(e.Fragment,{children:[e.jsx("form",{onSubmit:r.onSubmit(s=>L(s)),children:e.jsxs(j,{gap:"lg",direction:"column",mb:"xl",children:[e.jsx(A,{children:i==null?void 0:i.name}),e.jsx(g,{"aria-label":"Quiz Name",placeholder:"Quiz Name",label:"Quiz Name",withAsterisk:!0,required:!0,error:r.errors,...r.getInputProps("name")}),e.jsx(v,{"aria-label":"Quiz Questions",data:k,label:"Quiz Questions",placeholder:"Select Questions",searchable:!0,classNames:{value:f.value,defaultValueLabel:f.defaultValueLabel},error:r.errors,...r.getInputProps("questions")}),e.jsxs(Q,{position:"right",children:[e.jsx(x,{variant:"outline",onClick:N,children:"Back"}),e.jsx(x,{type:"submit",loading:y,children:"Update"})]})]})}),e.jsx("form",{onSubmit:n.onSubmit(s=>I(s)),children:e.jsxs(j,{gap:"lg",direction:"column",children:[e.jsxs(A,{order:2,children:[e.jsx(w,{my:"sm"}),"Add new question to Quiz Questions:"]}),e.jsx(g,{"aria-label":"Question",placeholder:"Question",label:"Question",withAsterisk:!0,error:n.errors,...n.getInputProps("question")}),e.jsx(g,{"aria-label":"Answer",placeholder:"Answer",label:"Answer",name:"answer",withAsterisk:!0,error:n.errors,...n.getInputProps("answer")}),e.jsx(Q,{children:e.jsx(x,{type:"submit",children:"Add"})})]})})]})};export{H as default};
