import{r as d,j as s,F as b,l as q,G as j,k as p}from"./index-4e0b3dbf.js";import{g as y,e as F,i as I,k as N}from"./styles-b1301c43.js";import{u as g,T as Q,M as v,D as B}from"./use-form-241aae4b.js";const R=()=>{const[a,w]=d.useState(),{goBack:f}=y(),{classes:z}=F(),{data:o}=I(),{mutate:x,isLoading:C}=N(),r=g({initialValues:{name:"",questions:[]},validate:e=>{const t={};return e.name||(t.name="Name is required"),e.questions||(t.questions="Questions are required"),t}}),i=g({initialValues:{answer:"",question:"",id:null,newQuestion:!0},validate:e=>{const t={};return e.answer||(t.answer="Answer is required"),e.question||(t.question="Question is required"),t}}),h=d.useMemo(()=>[...(o??[]).map(e=>({label:e.question,value:e.id.toString()})),...(a??[]).map(e=>({label:e.question,value:e.id!==null?e.id.toString():""}))],[o,a]),A=d.useCallback(e=>{const{question:t,answer:c}=e,u=crypto.getRandomValues(new Uint32Array(1))[0],l={question:t,answer:c,id:u,newQuestion:!0};w(m=>[...m||[],l]),i.reset(),r.setFieldValue("questions",[...r.values.questions||[],u.toString()])},[w,i]),S=d.useCallback(e=>{var l;const t=[...o??[],...a??[]],c=(l=e.questions)==null?void 0:l.map(m=>{const n=t==null?void 0:t.find(k=>k.id===Number(m));if(n)return"newQuestion"in n&&(n!=null&&n.newQuestion)?{question:n.question,answer:n.answer}:n}),u={name:e.name,questions:c??[]};x(u)},[x,o,a,h]);return s.jsxs(s.Fragment,{children:[s.jsx("form",{onSubmit:r.onSubmit(e=>S(e)),children:s.jsxs(b,{gap:"lg",direction:"column",mb:"xl",children:[s.jsx(q,{children:"Create Quiz"}),s.jsx(Q,{"aria-label":"Quiz Name",placeholder:"Quiz Name",label:"Quiz Name",withAsterisk:!0,...r.getInputProps("name")}),s.jsx(v,{"aria-label":"Quiz Questions",data:h,label:"Quiz Questions",placeholder:"Select Questions",searchable:!0,classNames:{value:z.value},...r.getInputProps("questions")}),s.jsxs(j,{position:"right",children:[s.jsx(p,{variant:"outline",onClick:f,children:"Back"}),s.jsx(p,{type:"submit",loading:C,children:"Create"})]})]})}),s.jsx("form",{onSubmit:i.onSubmit(e=>A(e)),children:s.jsxs(b,{gap:"lg",direction:"column",children:[s.jsxs(q,{order:2,children:[s.jsx(B,{my:"sm"}),"Add new question to Quiz Questions:"]}),s.jsx(Q,{"aria-label":"Question",placeholder:"Question",label:"Question",withAsterisk:!0,error:i.errors,...i.getInputProps("question")}),s.jsx(Q,{"aria-label":"Answer",placeholder:"Answer",label:"Answer",name:"answer",withAsterisk:!0,error:i.errors,...i.getInputProps("answer")}),s.jsx(j,{children:s.jsx(p,{type:"submit",children:"Add"})})]})})]})};export{R as default};
